# Data Models

Core data entities that flow through the Reddit-to-video pipeline, shared between frontend and backend with full TypeScript interfaces.

## RedditPost

**Purpose:** Represents discovered Reddit content with engagement metrics and processing state

**Key Attributes:**

- id: string - Unique identifier for database primary key
- reddit_id: string - Original Reddit post identifier for API correlation
- title: string - Post title for video content generation
- content: string - Full post text for script generation input
- url: string - Original Reddit URL for reference and attribution
- author: string - Reddit username for content attribution
- upvotes: number - Engagement metric for content scoring
- comments: number - Discussion engagement for popularity assessment
- created_date: Date - Post creation timestamp for trending analysis
- score: number - Calculated content quality score (0-10)
- status: ProcessingStatus - Current pipeline stage
- discovered_at: Date - When content was scraped by our system

### TypeScript Interface

```typescript
interface RedditPost {
  id: string;
  reddit_id: string;
  title: string;
  content: string;
  url: string;
  author: string;
  upvotes: number;
  comments: number;
  created_date: Date;
  score: number;
  status: ProcessingStatus;
  discovered_at: Date;
  updated_at: Date;
}

type ProcessingStatus =
  | "idea"
  | "idea_selected"
  | "script_generated"
  | "script_approved"
  | "script_rejected"
  | "assets_ready"
  | "rendering"
  | "completed"
  | "failed";
```

### Relationships

- Has one VideoScript (one-to-one after script generation)
- Has many VideoAssets (one-to-many for multiple visual elements)
- Has one VideoOutput (one-to-one final result)

## VideoScript

**Purpose:** AI-generated script content with scene breakdown and metadata for video production

**Key Attributes:**

- id: string - Unique script identifier
- post_id: string - Foreign key to source RedditPost
- script_content: string - Full narration text generated by Claude
- scene_breakdown: SceneData[] - Individual scenes with timing and keywords
- duration_target: number - Desired video length in seconds
- titles: string[] - 5 SEO-optimized title variations
- description: string - YouTube description with hashtags
- thumbnail_suggestions: ThumbnailConcept[] - Visual suggestions for thumbnails
- version: number - Script iteration for version control
- approved: boolean - Manual approval status
- generated_at: Date - Claude API generation timestamp

### TypeScript Interface

```typescript
interface VideoScript {
  id: string;
  post_id: string;
  script_content: string;
  scene_breakdown: SceneData[];
  duration_target: number;
  titles: string[];
  description: string;
  thumbnail_suggestions: ThumbnailConcept[];
  version: number;
  approved: boolean;
  generated_at: Date;
  approved_at?: Date;
}

interface SceneData {
  scene_number: number;
  content: string;
  keywords: string[];
  duration_estimate: number;
  emotional_tone: "motivational" | "contemplative" | "urgent";
}

interface ThumbnailConcept {
  text_overlay: string;
  emotional_style: string;
  visual_theme: string;
}
```

### Relationships

- Belongs to one RedditPost (many-to-one)
- Has many VideoAssets (one-to-many for scene assets)

## VideoAsset

**Purpose:** Pexels media assets matched to script scenes with quality metadata

**Key Attributes:**

- id: string - Unique asset identifier
- script_id: string - Foreign key to VideoScript
- scene_number: number - Which scene this asset belongs to
- pexels_id: number - Original Pexels asset identifier
- asset_type: 'video' | 'image' - Media type for rendering pipeline
- url: string - Pexels download URL
- local_path: string - Cached file location
- photographer: string - Attribution requirement
- duration?: number - Video length in seconds (null for images)
- resolution: string - Asset dimensions (e.g., "1920x1080")
- relevance_score: number - AI-calculated relevance to scene (0-1)
- approved: boolean - Manual quality approval status

### TypeScript Interface

```typescript
interface VideoAsset {
  id: string;
  script_id: string;
  scene_number: number;
  pexels_id: number;
  asset_type: "video" | "image";
  url: string;
  local_path: string;
  photographer: string;
  duration?: number;
  resolution: string;
  relevance_score: number;
  approved: boolean;
  cached_at: Date;
}
```

### Relationships

- Belongs to one VideoScript (many-to-one)
- Links to SceneData via scene_number

## BackgroundMusic

**Purpose:** Royalty-free background music tracks for video atmosphere and engagement

**Key Attributes:**

- id: string - Unique music track identifier
- title: string - Track name for user selection
- file_path: string - Local storage location
- duration: number - Track length in seconds
- emotional_tone: 'motivational' | 'contemplative' | 'urgent' | 'neutral' - Matching script emotions
- genre: string - Music category (ambient, upbeat, cinematic, etc.)
- volume_level: number - Recommended mixing volume (0-1)
- loop_enabled: boolean - Whether track can loop for longer videos
- artist: string - Attribution information
- license: string - Usage rights confirmation

### TypeScript Interface

```typescript
interface BackgroundMusic {
  id: string;
  title: string;
  file_path: string;
  duration: number;
  emotional_tone: "motivational" | "contemplative" | "urgent" | "neutral";
  genre: string;
  volume_level: number;
  loop_enabled: boolean;
  artist: string;
  license: string;
  created_at: Date;
}

interface MusicSelection {
  id: string;
  script_id: string;
  music_id: string;
  selected_at: Date;
  volume_adjustment?: number;
  fade_in_duration?: number;
  fade_out_duration?: number;
}
```

### Relationships

- Has many MusicSelections (one-to-many for different videos)
- MusicSelection belongs to one VideoScript (many-to-one)

## VideoOutput

**Purpose:** Final rendered video with metadata and delivery information

**Key Attributes:**

- id: string - Unique output identifier
- post_id: string - Source Reddit post reference
- script_id: string - Script version used for rendering
- file_path: string - Local or cloud storage location
- file_size: number - Video file size in bytes
- duration: number - Actual video length in seconds
- resolution: string - Final video dimensions
- render_settings: RenderConfig - Remotion configuration used
- status: 'rendering' | 'completed' | 'failed' - Processing state
- thumbnail_paths: string[] - Generated thumbnail options
- metadata: VideoMetadata - YouTube-ready information
- rendered_at: Date - Completion timestamp

### TypeScript Interface

```typescript
interface VideoOutput {
  id: string;
  post_id: string;
  script_id: string;
  file_path: string;
  file_size: number;
  duration: number;
  resolution: string;
  render_settings: RenderConfig;
  status: "rendering" | "completed" | "failed";
  thumbnail_paths: string[];
  metadata: VideoMetadata;
  rendered_at?: Date;
  error_message?: string;
}

interface RenderConfig {
  fps: number;
  codec: string;
  bitrate: string;
  template: string;
}

interface VideoMetadata {
  title: string;
  description: string;
  tags: string[];
  category: string;
}
```

### Relationships

- Belongs to one RedditPost (one-to-one)
- References one VideoScript (many-to-one, versions)
