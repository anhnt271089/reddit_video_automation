# Story 3.2: Content Scoring System

## Status

Draft

## Story

**As a** content curator,  
**I want** an intelligent scoring system that ranks Reddit posts by quality and video potential,  
**so that** I can prioritize the best content and make faster approval decisions based on data-driven insights.

## Acceptance Criteria

1. Scoring algorithm calculates quality scores from 0-10 based on multiple factors
2. Engagement metrics weighted appropriately (upvotes, comments, ratio)
3. Content quality factors assessed (length, readability, video suitability)
4. Age decay factor prevents stale content from ranking highly
5. Manual score adjustments allow curator override of algorithmic scoring
6. Score explanations show factor breakdown for transparency
7. Scoring thresholds enable automatic filtering of low-quality content
8. Historical performance tracking improves scoring accuracy over time
9. Score recalculation updates existing posts when algorithm improves

## Tasks / Subtasks

- [ ] **Task 1: Design Core Scoring Algorithm** (AC: 1, 2, 3, 4)
  - [ ] Create src/services/scoring/algorithm.ts
  - [ ] Implement base scoring function:
    - Input: RedditPost object
    - Output: Score (0-10) with factor breakdown
    - Configurable factor weights
  - [ ] Define scoring factors:
    - Engagement Score (40%): upvotes, comments, upvote ratio
    - Content Quality (30%): word count, readability, structure
    - Timeliness (20%): age decay, trending velocity
    - Video Suitability (10%): narrative potential, visual concepts
  - [ ] Create factor calculation functions
  - [ ] Test algorithm with sample posts

- [ ] **Task 2: Implement Engagement Scoring** (AC: 2)
  - [ ] Create engagement scoring logic:
    - Upvote count with logarithmic scaling
    - Comment engagement with quality weighting
    - Upvote ratio impact (minimum 0.7 for high scores)
    - Comment-to-upvote ratio analysis
  - [ ] Add engagement velocity tracking:
    - Upvotes per hour since posting
    - Comment growth rate
    - Cross-post performance indicators
  - [ ] Create engagement normalization:
    - Adjust for subreddit size
    - Account for time-of-day posting effects
    - Handle outlier detection
  - [ ] Test with various engagement patterns

- [ ] **Task 3: Build Content Quality Assessment** (AC: 3)
  - [ ] Create content analysis service:
    - Word count optimization (200-800 words ideal)
    - Readability score calculation (Flesch-Kincaid)
    - Sentence structure analysis
    - Paragraph organization check
  - [ ] Implement video suitability scoring:
    - Narrative structure presence
    - Emotional arc identification
    - Visual concept extraction
    - Action-oriented language detection
  - [ ] Add content filters:
    - Profanity detection and scoring impact
    - Spam/promotional content identification
    - Off-topic content detection
  - [ ] Test content quality metrics

- [ ] **Task 4: Implement Age Decay System** (AC: 4)
  - [ ] Create time-based scoring decay:
    - Peak score at 6-24 hours
    - Linear decay after 48 hours
    - Minimum score floor (20% of original)
    - Trending boost for rapid engagement
  - [ ] Add seasonal adjustments:
    - Weekend vs weekday posting patterns
    - Holiday and event considerations
    - Subreddit activity cycles
  - [ ] Implement trending detection:
    - Velocity-based trending identification
    - Viral content early detection
    - Trending boost application
  - [ ] Test decay curves with historical data

- [ ] **Task 5: Create Manual Score Adjustment** (AC: 5, 6)
  - [ ] Build score override system:
    - Manual score input interface
    - Override reason tracking
    - Original vs adjusted score display
    - Override audit logging
  - [ ] Implement score explanation UI:
    - Factor breakdown visualization
    - Score component charts
    - Comparison with similar posts
    - Improvement suggestions
  - [ ] Add curator feedback loop:
    - Track manual adjustments
    - Identify algorithm improvements
    - Learn from curator preferences
  - [ ] Test manual override workflow

- [ ] **Task 6: Implement Scoring Thresholds** (AC: 7)
  - [ ] Create configurable thresholds:
    - High quality: 7.5+ (auto-highlight)
    - Medium quality: 5.0-7.4 (standard review)
    - Low quality: 2.0-4.9 (manual review required)
    - Very low: <2.0 (auto-hide option)
  - [ ] Build threshold-based filtering:
    - Filter UI controls
    - Threshold configuration interface
    - Batch hide/show by threshold
  - [ ] Add threshold notifications:
    - High-quality content alerts
    - Threshold breach notifications
    - Daily quality summaries
  - [ ] Test threshold effectiveness

- [ ] **Task 7: Build Performance Tracking** (AC: 8)
  - [ ] Create performance metrics database:
    - Post approval rates by score
    - Video completion rates by score
    - View performance by score range
    - Engagement correlation tracking
  - [ ] Implement learning system:
    - Track scoring accuracy over time
    - Identify scoring improvements needed
    - Adjust weights based on performance
  - [ ] Add performance analytics:
    - Scoring accuracy reports
    - Factor effectiveness analysis
    - Curator agreement metrics
  - [ ] Build performance dashboard

- [ ] **Task 8: Implement Score Recalculation** (AC: 9)
  - [ ] Create batch recalculation system:
    - Recalculate all posts with new algorithm
    - Maintain score history for comparison
    - Gradual rollout of algorithm changes
  - [ ] Add recalculation triggers:
    - Algorithm version updates
    - Manual recalculation requests
    - Scheduled recalculation jobs
  - [ ] Build migration system:
    - Version tracking for algorithms
    - Backward compatibility
    - Score migration utilities
  - [ ] Test recalculation performance

- [ ] **Task 9: Create Scoring API and UI Integration** (AC: 1, 5, 6)
  - [ ] Create src/routes/api/scoring.ts
  - [ ] Implement scoring endpoints:
    - POST /api/scoring/calculate - Calculate score for post
    - PUT /api/scoring/:id/adjust - Manual score adjustment
    - GET /api/scoring/:id/explanation - Score breakdown
    - POST /api/scoring/recalculate - Batch recalculation
  - [ ] Update PostCard component:
    - Score visualization with color coding
    - Score explanation tooltip
    - Manual adjustment interface
  - [ ] Add scoring configuration UI:
    - Weight adjustment sliders
    - Threshold configuration
    - Algorithm version selection
  - [ ] Test UI integration

## Dev Notes

### Architecture Context

- **Scoring Range:** 0-10 scale with decimal precision
- **Update Frequency:** Real-time for new posts, batch for historical
- **Performance:** Sub-100ms calculation time per post
- **Configurability:** All weights and thresholds adjustable

### Scoring Formula

```
Total Score = (
  Engagement Score Ã— 0.40 +
  Content Quality Ã— 0.30 +
  Timeliness Ã— 0.20 +
  Video Suitability Ã— 0.10
) Ã— Manual Multiplier
```

### Factor Calculations

```typescript
// Engagement (0-10)
engagementScore =
  log10(upvotes + 1) * 2 + log10(comments + 1) * 1.5 + upvoteRatio * 2;

// Content Quality (0-10)
contentScore =
  wordCountScore * 0.4 + readabilityScore * 0.3 + structureScore * 0.3;

// Age Decay Multiplier (0.2-1.0)
ageMultiplier = max(0.2, 1 - (ageHours - 24) / 240);
```

### Score Visualization

```
Score Ranges:
ðŸŸ¢ 8.0-10.0: Excellent (green)
ðŸŸ¡ 6.0-7.9:  Good (yellow)
ðŸŸ  4.0-5.9:  Fair (orange)
ðŸ”´ 0.0-3.9:  Poor (red)
```

### Database Schema Updates

```sql
-- Add scoring columns to reddit_posts
ALTER TABLE reddit_posts ADD COLUMN calculated_score REAL DEFAULT 0;
ALTER TABLE reddit_posts ADD COLUMN manual_score REAL;
ALTER TABLE reddit_posts ADD COLUMN score_factors JSON;
ALTER TABLE reddit_posts ADD COLUMN algorithm_version TEXT DEFAULT 'v1.0';

-- Score history table
CREATE TABLE score_history (
  id TEXT PRIMARY KEY,
  post_id TEXT REFERENCES reddit_posts(id),
  score REAL,
  algorithm_version TEXT,
  calculated_at TIMESTAMP
);
```

### Testing Standards

- Unit tests for each scoring factor
- Integration tests for full algorithm
- Performance tests with large datasets
- A/B testing for algorithm improvements
- Historical data validation

## Change Log

| Date       | Version | Description            | Author    |
| ---------- | ------- | ---------------------- | --------- |
| 2025-08-26 | 1.0     | Initial story creation | John (PM) |

## Dev Agent Record

(To be populated during implementation)

## QA Results

(To be populated during QA review)
