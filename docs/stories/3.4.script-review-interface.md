# Story 3.4: Script Review Interface

## Status

Draft

## Story

**As a** content creator,  
**I want** a comprehensive script review and editing interface,  
**so that** I can review, edit, and approve AI-generated scripts before proceeding to video production.

## Acceptance Criteria

1. Script editor displays formatted script content with scene breakdown visualization
2. Inline editing allows modifications to script text with real-time preview
3. Scene management enables reordering, splitting, and merging scenes
4. Keyword visualization shows extracted keywords with edit capabilities
5. YouTube metadata review allows editing titles, descriptions, and thumbnails
6. Approval workflow tracks script status and triggers asset generation
7. Version comparison shows differences between script iterations
8. Timing estimates update automatically as content is edited
9. Export functionality provides formatted script for external use

## Tasks / Subtasks

- [ ] **Task 1: Create Script Display Component** (AC: 1, 8)
  - [ ] Create src/components/features/ScriptReview/ScriptDisplay.tsx
  - [ ] Implement script visualization:
    - Full script text with formatting
    - Scene boundaries with visual separators
    - Scene numbers and timing indicators
    - Word count and duration estimates
  - [ ] Add scene breakdown sidebar:
    - Collapsible scene list
    - Scene timing visualization
    - Jump to scene navigation
    - Scene status indicators
  - [ ] Create timing calculation display:
    - Real-time duration updates
    - Words per minute indicators
    - Scene balance visualization
    - Total video duration estimate
  - [ ] Apply professional styling with Tailwind

- [ ] **Task 2: Build Inline Editing System** (AC: 2, 8)
  - [ ] Create editable script component:
    - Rich text editing capabilities
    - Paragraph-level editing
    - Auto-save functionality
    - Edit history tracking
  - [ ] Implement real-time preview:
    - Live timing updates
    - Scene boundary detection
    - Keyword highlighting
    - Format preservation
  - [ ] Add editing controls:
    - Bold/italic formatting
    - Paragraph management
    - Undo/redo functionality
    - Copy/paste handling
  - [ ] Create edit validation:
    - Character count limits
    - Scene length warnings
    - Duration estimate updates

- [ ] **Task 3: Implement Scene Management** (AC: 3, 8)
  - [ ] Create src/components/features/ScriptReview/SceneManager.tsx
  - [ ] Build scene operations:
    - Drag and drop reordering
    - Scene splitting at cursor position
    - Scene merging with adjacent scenes
    - Scene deletion with confirmation
  - [ ] Add scene editing:
    - Individual scene text editing
    - Scene title modification
    - Scene timing adjustments
    - Keywords per scene editing
  - [ ] Implement scene validation:
    - Minimum scene length
    - Maximum scene count
    - Timing distribution check
    - Content flow validation
  - [ ] Create scene navigation:
    - Scene thumbnail previews
    - Quick scene jumping
    - Scene search functionality

- [ ] **Task 4: Build Keywords Management** (AC: 4)
  - [ ] Create src/components/features/ScriptReview/KeywordEditor.tsx
  - [ ] Display keyword visualization:
    - Keywords grouped by scene
    - Keyword frequency analysis
    - Visual keyword tags
    - Keyword relevance scoring
  - [ ] Implement keyword editing:
    - Add/remove keywords per scene
    - Keyword suggestion system
    - Bulk keyword operations
    - Keyword category management
  - [ ] Add keyword validation:
    - Keyword relevance checking
    - Duplicate keyword detection
    - Asset availability verification
    - Keyword optimization suggestions
  - [ ] Create keyword export:
    - Export for asset search
    - Keyword performance tracking
    - SEO keyword analysis

- [ ] **Task 5: Create Metadata Review Interface** (AC: 5)
  - [ ] Create src/components/features/ScriptReview/MetadataEditor.tsx
  - [ ] Build title editor:
    - Display all 5 title variations
    - Inline title editing
    - Character count indicators
    - CTR optimization suggestions
  - [ ] Implement description editor:
    - Rich text description editing
    - Hashtag management
    - SEO optimization hints
    - Template insertion
  - [ ] Add thumbnail concept manager:
    - Visual concept descriptions
    - Concept editing interface
    - Preview mock-ups if possible
    - Concept ranking system
  - [ ] Create metadata validation:
    - Title length limits
    - Description optimization
    - Hashtag relevance check

- [ ] **Task 6: Implement Approval Workflow** (AC: 6)
  - [ ] Create approval system:
    - Script approval button
    - Approval confirmation dialog
    - Status update mechanism
    - Next step trigger (asset generation)
  - [ ] Build rejection workflow:
    - Rejection with feedback
    - Regeneration request
    - Manual editing requirements
    - Rejection reason tracking
  - [ ] Add approval validation:
    - Completeness check
    - Quality threshold validation
    - Required fields verification
  - [ ] Implement approval notifications:
    - WebSocket status updates
    - Email notifications if configured
    - Dashboard status updates

- [ ] **Task 7: Build Version Comparison** (AC: 7)
  - [ ] Create src/components/features/ScriptReview/VersionComparison.tsx
  - [ ] Implement diff visualization:
    - Side-by-side comparison
    - Highlighted changes
    - Line-by-line differences
    - Scene-level changes
  - [ ] Add version navigation:
    - Version dropdown selector
    - Version timestamp display
    - Version metadata
    - Revert functionality
  - [ ] Create change tracking:
    - Change type identification
    - Change impact analysis
    - Version performance comparison
  - [ ] Build version management:
    - Create new versions
    - Archive old versions
    - Version naming system

- [ ] **Task 8: Add Export Functionality** (AC: 9)
  - [ ] Create export service:
    - Plain text export
    - Formatted document export (PDF)
    - JSON export for API use
    - Teleprompter format
  - [ ] Implement export options:
    - Include/exclude metadata
    - Scene breakdown formatting
    - Timing information inclusion
    - Custom formatting options
  - [ ] Add export formats:
    - Standard script format
    - Video production format
    - Markdown export
    - CSV for data analysis
  - [ ] Create export UI:
    - Export format selection
    - Download trigger
    - Export history tracking

- [ ] **Task 9: Create Review Workflow Integration** (AC: 1-9)
  - [ ] Build main review interface:
    - Integrate all components
    - Create workflow navigation
    - Add progress indicators
    - Implement responsive design
  - [ ] Add workflow state management:
    - Track review progress
    - Save draft changes
    - Handle unsaved changes warnings
    - Maintain review session state
  - [ ] Create review analytics:
    - Time spent reviewing
    - Changes made tracking
    - Review completion rate
    - Quality improvement metrics
  - [ ] Implement keyboard shortcuts:
    - Quick approval (Ctrl+Enter)
    - Scene navigation (arrow keys)
    - Edit mode toggle (E)
    - Save draft (Ctrl+S)

## Dev Notes

### Architecture Context

- **Framework:** React 18 with TypeScript
- **Text Editor:** Rich text editing with formatting preservation
- **State Management:** Zustand with optimistic updates
- **Real-time:** Live timing calculations and auto-save

### Component Hierarchy

```
ScriptReview/
├── ScriptDisplay
│   ├── ScriptEditor (inline editing)
│   └── TimingIndicators
├── SceneManager
│   ├── SceneList
│   └── SceneOperations
├── KeywordEditor
├── MetadataEditor
│   ├── TitleEditor
│   ├── DescriptionEditor
│   └── ThumbnailConcepts
├── VersionComparison
└── ApprovalControls
```

### Edit State Management

```typescript
interface ScriptEditState {
  originalScript: VideoScript;
  currentScript: VideoScript;
  hasUnsavedChanges: boolean;
  editHistory: EditAction[];
  autoSaveEnabled: boolean;
  lastSaved: Date;
}
```

### Scene Operations

```typescript
interface SceneOperation {
  type: "reorder" | "split" | "merge" | "delete" | "edit";
  sceneIndex: number;
  payload: any;
  timestamp: Date;
}
```

### Keyboard Shortcuts

```
Ctrl+S: Save draft
Ctrl+Enter: Approve script
Ctrl+Z: Undo change
Ctrl+Y: Redo change
E: Toggle edit mode
Esc: Exit edit mode
Arrow keys: Navigate scenes
```

### Database Updates

```sql
-- Track script review sessions
CREATE TABLE script_review_sessions (
  id TEXT PRIMARY KEY,
  script_id TEXT REFERENCES video_scripts(id),
  user_id TEXT,
  started_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  completed_at TIMESTAMP,
  changes_made INTEGER DEFAULT 0,
  time_spent INTEGER DEFAULT 0
);

-- Track edit history
CREATE TABLE script_edit_history (
  id TEXT PRIMARY KEY,
  script_id TEXT REFERENCES video_scripts(id),
  operation_type TEXT,
  changes JSON,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### Testing Standards

- Component testing with React Testing Library
- Edit functionality integration tests
- Version management workflow tests
- Approval process end-to-end tests
- Keyboard shortcut testing

## Change Log

| Date       | Version | Description            | Author    |
| ---------- | ------- | ---------------------- | --------- |
| 2025-08-26 | 1.0     | Initial story creation | John (PM) |

## Dev Agent Record

(To be populated during implementation)

## QA Results

(To be populated during QA review)
