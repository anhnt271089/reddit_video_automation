# Story 3.1: Content Discovery Dashboard

## Status

Draft

## Story

**As a** content curator,  
**I want** an intuitive dashboard to review and approve discovered Reddit posts,  
**so that** I can efficiently select high-quality content for video creation with clear visibility into post metrics and pipeline status.

## Acceptance Criteria

1. Dashboard displays Reddit posts in responsive card layout with key metrics
2. Real-time WebSocket updates show new posts and status changes without page refresh
3. Filtering system allows sorting by score, date, status, and upvotes
4. Batch approval actions enable efficient multi-post selection
5. Post cards show title, excerpt, engagement metrics, and quality score
6. Approval workflow updates database state and triggers script generation
7. Infinite scroll or pagination handles large numbers of posts efficiently
8. Search functionality finds posts by title or content keywords
9. Visual indicators clearly show post status throughout pipeline

## Tasks / Subtasks

- [ ] **Task 1: Create Post Card Components** (AC: 1, 5, 9)
  - [ ] Create src/components/features/ContentDiscovery/PostCard.tsx
  - [ ] Implement post card design:
    - Title with character limit and ellipsis
    - Content excerpt (first 150 characters)
    - Engagement metrics (upvotes, comments, score)
    - Author and subreddit display
    - Created date with relative formatting
    - Status badge with color coding
  - [ ] Add interactive elements:
    - Expand/collapse for full content
    - Approve/reject buttons
    - Quality score visualization
    - Direct link to original Reddit post
  - [ ] Apply Tailwind styling with hover states
  - [ ] Test responsive design across screen sizes

- [ ] **Task 2: Build Dashboard Layout** (AC: 1, 7)
  - [ ] Create src/pages/ContentReview.tsx
  - [ ] Implement responsive grid layout:
    - 1 column on mobile
    - 2 columns on tablet
    - 3 columns on desktop
    - 4 columns on large screens
  - [ ] Add dashboard header:
    - Page title and description
    - Quick action buttons
    - Stats overview (total posts, pending, approved)
  - [ ] Implement scroll handling:
    - Infinite scroll with intersection observer
    - Loading indicators
    - Empty state messaging
  - [ ] Test performance with 100+ posts

- [ ] **Task 3: Implement Filtering System** (AC: 3, 8)
  - [ ] Create src/components/features/ContentDiscovery/PostFilters.tsx
  - [ ] Build filter controls:
    - Sort dropdown (score, date, upvotes, comments)
    - Status filter (all, pending, approved, rejected)
    - Date range picker
    - Minimum score threshold slider
  - [ ] Add search functionality:
    - Search input with debouncing
    - Search by title and content
    - Clear search button
    - Search result highlighting
  - [ ] Create filter state management:
    - URL parameter persistence
    - Filter combination logic
    - Reset filters functionality
  - [ ] Test filter performance and combinations

- [ ] **Task 4: Build WebSocket Integration** (AC: 2)
  - [ ] Create src/hooks/useContentUpdates.ts
  - [ ] Implement WebSocket message handling:
    - Connect to /ws endpoint
    - Listen for post_status_update events
    - Handle new posts discovered events
    - Process batch update messages
  - [ ] Update UI state from WebSocket:
    - Add new posts to existing list
    - Update post status indicators
    - Show toast notifications for updates
    - Handle connection/disconnection states
  - [ ] Add connection status indicator
  - [ ] Test real-time updates with concurrent users

- [ ] **Task 5: Implement Batch Actions** (AC: 4, 6)
  - [ ] Create src/components/features/ContentDiscovery/BatchActions.tsx
  - [ ] Build batch selection system:
    - Master checkbox for select all
    - Individual post checkboxes
    - Selected count indicator
    - Clear selection button
  - [ ] Implement batch operations:
    - Approve selected posts
    - Reject selected posts
    - Bulk status updates
    - Confirmation dialogs for batch actions
  - [ ] Add batch action feedback:
    - Progress indicators
    - Success/error notifications
    - Undo functionality where appropriate
  - [ ] Test batch operations with large selections

- [ ] **Task 6: Create Approval Workflow** (AC: 6)
  - [ ] Create src/services/contentApproval.ts
  - [ ] Implement approval logic:
    - Single post approval
    - Status update to 'idea_selected'
    - Database transaction handling
    - Error handling for failed updates
  - [ ] Add approval triggers:
    - Automatic script generation queuing
    - WebSocket notification broadcast
    - UI state synchronization
    - Audit logging for approvals
  - [ ] Create approval confirmation:
    - Visual feedback on approval
    - Prevent duplicate approvals
    - Handle approval conflicts
  - [ ] Test approval workflow end-to-end

- [ ] **Task 7: Add Performance Optimizations** (AC: 7)
  - [ ] Implement virtualization for large lists:
    - React Window for efficient rendering
    - Dynamic item sizing
    - Scroll position preservation
    - Memory usage optimization
  - [ ] Add data pagination:
    - Backend pagination support
    - Page size configuration
    - Pre-loading adjacent pages
    - Smooth page transitions
  - [ ] Optimize re-renders:
    - React memo for post cards
    - Callback memoization
    - State update batching
  - [ ] Test with 1000+ posts

- [ ] **Task 8: Create Dashboard State Management** (AC: 2, 3, 4)
  - [ ] Update src/stores/useAppStore.ts
  - [ ] Add posts slice to store:
    - Posts array state
    - Loading states
    - Filter states
    - Selection states
  - [ ] Implement store actions:
    - Load posts with filters
    - Update post status
    - Handle batch selections
    - WebSocket state updates
  - [ ] Add derived state selectors:
    - Filtered post lists
    - Selected post counts
    - Loading indicators
  - [ ] Test state consistency across components

## Dev Notes

### Architecture Context

- **Frontend Framework:** React 18 with TypeScript
- **State Management:** Zustand store with selectors
- **Styling:** Tailwind CSS with responsive design
- **Real-time:** WebSocket connection to backend
- **Performance:** React Window for virtualization

### Component Hierarchy

```
ContentReview/
â”œâ”€â”€ Dashboard Header
â”œâ”€â”€ PostFilters
â”‚   â”œâ”€â”€ Sort Controls
â”‚   â”œâ”€â”€ Status Filter
â”‚   â””â”€â”€ Search Input
â”œâ”€â”€ BatchActions
â””â”€â”€ PostGrid
    â””â”€â”€ PostCard[]
```

### WebSocket Events

Listen for these events from backend:

- `posts_discovered`: New posts added
- `post_status_update`: Status changes
- `batch_update_complete`: Batch operations finished

### Post Card Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Score] Title...            â”‚
â”‚ Content excerpt...          â”‚
â”‚ ğŸ‘ upvotes ğŸ’¬ comments     â”‚
â”‚ u/author â€¢ 2h ago           â”‚
â”‚ [Approve] [Reject] [More]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### State Structure

```typescript
interface PostsState {
  items: RedditPost[];
  loading: boolean;
  filters: PostFilters;
  selectedIds: string[];
  searchQuery: string;
  sortBy: SortOption;
}
```

### Testing Standards

- Component testing with React Testing Library
- WebSocket message handling tests
- Filter and search functionality tests
- Batch action integration tests
- Performance testing with large datasets

## Change Log

| Date       | Version | Description            | Author    |
| ---------- | ------- | ---------------------- | --------- |
| 2025-08-26 | 1.0     | Initial story creation | John (PM) |

## Dev Agent Record

(To be populated during implementation)

## QA Results

(To be populated during QA review)
